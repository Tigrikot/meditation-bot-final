import time
import telebot
from telebot import types
import hashlib
import sqlite3
from telebot.types import InlineKeyboardButton, InlineKeyboardMarkup, ReplyKeyboardMarkup, KeyboardButton
import shortuuid

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞ —Å –≤–∞—à–∏–º —Ç–æ–∫–µ–Ω–æ–º
bot = telebot.TeleBot('—Ç–≤–æ–π —Ç–æ–∫–µ–Ω')

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º check_same_thread=False –¥–ª—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
conn = sqlite3.connect('media.db', check_same_thread=False)
cursor = conn.cursor()

# SQL –∑–∞–ø—Ä–æ—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã 'media', –µ—Å–ª–∏ –æ–Ω–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
create_table_query = """
CREATE TABLE IF NOT EXISTS media (
    id INTEGER PRIMARY KEY AUTOINCREMENT, 
    file_id TEXT,                          
    file_type TEXT NOT NULL,               
    unique_key TEXT UNIQUE NOT NULL,       
    caption TEXT                           
);
"""
cursor.execute(create_table_query)
conn.commit()

# SQL –∑–∞–ø—Ä–æ—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã 'meditate', –µ—Å–ª–∏ –æ–Ω–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
create_table_query = """
CREATE TABLE IF NOT EXISTS meditate (
    id INTEGER PRIMARY KEY AUTOINCREMENT, 
    file_id TEXT,                          
    file_type TEXT NOT NULL,               
    unique_key TEXT UNIQUE NOT NULL,       
    caption TEXT                           
);
"""
cursor.execute(create_table_query)
conn.commit()

# SQL –∑–∞–ø—Ä–æ—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã 'users', –µ—Å–ª–∏ –æ–Ω–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
cursor.execute('''
CREATE TABLE IF NOT EXISTS users (
    user_id INTEGER PRIMARY KEY 
)
''')
conn.commit()

# –°–ª–æ–≤–∞—Ä—å –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
user_status = {}
# –°–ª–æ–≤–∞—Ä—å –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
user_post_status = {}
# –°–ª–æ–≤–∞—Ä—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: –∫–ª—é—á - chat_id –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∑–Ω–∞—á–µ–Ω–∏–µ - —Ç–µ–∫—Å—Ç –ø–æ–¥–ø–∏—Å–∏
user_captions = {}


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start
@bot.message_handler(commands=['start'])
def handle_start(message):
    try:
        user_id = message.chat.id

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
        cursor.execute('SELECT user_id FROM users WHERE user_id = ?', (user_id,))
        if cursor.fetchone() is None:
            # –ï—Å–ª–∏ –Ω–µ—Ç, –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            cursor.execute('INSERT INTO users (user_id) VALUES (?)', (user_id,))
            conn.commit()

        # –°–±—Ä–æ—Å —Å—Ç–∞—Ç—É—Å–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        user_status[message.chat.id] = None

        # –°–æ–∑–¥–∞–µ–º –æ–±—ã—á–Ω—É—é –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –º–µ–Ω—é –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        markup = ReplyKeyboardMarkup(resize_keyboard=True, one_time_keyboard=True)
        button = KeyboardButton("–ú–µ–¥–∏—Ç–∞—Ü–∏—è üïâ")
        markup.add(button)
        bot.send_message(user_id, "–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –ú–µ–Ω—é –∏–ª–∏ –Ω–∞—á–Ω–∏—Ç–µ –ú–µ–¥–∏—Ç–∞—Ü–∏—é üïâ", reply_markup=markup)
    except sqlite3.Error as e:
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–æ–º–∞–Ω–¥—ã /start: {e}")


# –ì–ª–æ–±–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ç–µ–∫—É—â–µ–π –º–µ–¥–∏—Ç–∞—Ü–∏–∏
current_meditation_index = 0


# –ú–µ—Ç–æ–¥ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –º–µ–¥–∏—Ç–∞—Ü–∏–∏ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
def send_meditation(chat_id, file_id, file_type, caption):
    try:
        markup = types.InlineKeyboardMarkup()
        next_button = types.InlineKeyboardButton("–°–ª–µ–¥—É—é—â–∞—è –º–µ–¥–∏—Ç–∞—Ü–∏—è", callback_data='next_meditation')
        markup.add(next_button)

        if file_type == 'text':
            bot.send_message(chat_id, caption, reply_markup=markup)
        elif file_type == 'photo':
            bot.send_photo(chat_id, file_id, caption=caption, reply_markup=markup)
        elif file_type == 'audio':
            bot.send_audio(chat_id, file_id, caption=caption, reply_markup=markup)
        elif file_type == 'video':
            bot.send_video(chat_id, file_id, caption=caption, reply_markup=markup)
        elif file_type == 'document':
            bot.send_document(chat_id, file_id, caption=caption, reply_markup=markup)
        # –î–æ–±–∞–≤—å—Ç–µ –¥—Ä—É–≥–∏–µ —Ç–∏–ø—ã –º–µ–¥–∏–∞ –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
        else:
            bot.send_message(chat_id, "–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ç–∏–ø —Ñ–∞–π–ª–∞.", reply_markup=markup)
    except Exception as e:
        # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω–æ –≤–æ–∑–Ω–∏–∫–ª–æ
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –º–µ–¥–∏—Ç–∞—Ü–∏–∏: {e}")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã "–ú–µ–¥–∏—Ç–∞—Ü–∏—è üïâ"
@bot.message_handler(func=lambda message: message.text == "–ú–µ–¥–∏—Ç–∞—Ü–∏—è üïâ")
def handle_meditation_menu(message):
    global current_meditation_index
    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –º–µ–¥–∏—Ç–∞—Ü–∏–∏
        cursor.execute("SELECT file_id, file_type, caption FROM meditate ORDER BY id ASC")
        meditations = cursor.fetchall()

        if meditations:
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –º–µ–¥–∏—Ç–∞—Ü–∏—é, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Ç–µ–∫—É—â–µ–º—É –∏–Ω–¥–µ–∫—Å—É
            file_id, file_type, caption = meditations[current_meditation_index]
            send_meditation(message.chat.id, file_id, file_type, caption)

            # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∏–Ω–¥–µ–∫—Å –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
            current_meditation_index = (current_meditation_index + 1) % len(meditations)
        else:
            bot.send_message(message.chat.id, "–ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –º–µ–¥–∏—Ç–∞—Ü–∏–π –Ω–µ—Ç.")
    except Exception as e:
        # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω–æ –≤–æ–∑–Ω–∏–∫–ª–æ
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –º–µ–¥–∏—Ç–∞—Ü–∏—é: {e}")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫—É "–°–ª–µ–¥—É—é—â–∞—è –º–µ–¥–∏—Ç–∞—Ü–∏—è"
@bot.callback_query_handler(func=lambda call: call.data == 'next_meditation')
def handle_next_meditation(call):
    global current_meditation_index
    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –º–µ–¥–∏—Ç–∞—Ü–∏–∏
        cursor.execute("SELECT file_id, file_type, caption FROM meditate ORDER BY id ASC")
        meditations = cursor.fetchall()

        if current_meditation_index < len(meditations):
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –º–µ–¥–∏—Ç–∞—Ü–∏—é, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Ç–µ–∫—É—â–µ–º—É –∏–Ω–¥–µ–∫—Å—É
            file_id, file_type, caption = meditations[current_meditation_index]
            send_meditation(call.message.chat.id, file_id, file_type, caption)

            # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∏–Ω–¥–µ–∫—Å –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
            current_meditation_index = (current_meditation_index + 1) % len(meditations)
        else:
            bot.answer_callback_query(call.id, "–ë–æ–ª—å—à–µ –º–µ–¥–∏—Ç–∞—Ü–∏–π –Ω–µ—Ç.")
    except Exception as e:
        # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω–æ –≤–æ–∑–Ω–∏–∫–ª–æ
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é –º–µ–¥–∏—Ç–∞—Ü–∏—é: {e}")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –≤—Ö–æ–¥–∞ –≤ —Ä–µ–∂–∏–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
@bot.message_handler(commands=['admin6556'])
def handle_admin(message):
    try:
        user_id = message.chat.id  # –ü–æ–ª—É—á–µ–Ω–∏–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –æ—Ç–ø—Ä–∞–≤–∏–≤—à–µ–≥–æ –∫–æ–º–∞–Ω–¥—É
        user_status[user_id] = "admin6556"  # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
        send_admin_keyboard(user_id)  # –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
    except Exception as e:
        # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫
        print(f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –≤ handle_admin: {e}")


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
def send_admin_keyboard(user_id):
    try:
        # –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º resize_keyboard –¥–ª—è –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –ø–æ–¥ —Ä–∞–∑–º–µ—Ä —ç–∫—Ä–∞–Ω–∞
        markup = types.ReplyKeyboardMarkup(resize_keyboard=True)

        # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –¥–ª—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        item_publish = types.KeyboardButton("üü¢ –°–¥–µ–ª–∞—Ç—å –ø–æ—Å—Ç")
        item_add = types.KeyboardButton("üü¢ –î–æ–±–∞–≤–∏—Ç—å –∞–Ω–æ–Ω—Å")
        item_remove = types.KeyboardButton("üî¥ –£–¥–∞–ª–∏—Ç—å –∞–Ω–æ–Ω—Å")
        item_show_all_files = types.KeyboardButton("üü† –í—Å–µ –∞–Ω–æ–Ω—Å—ã")
        item_user_count = types.KeyboardButton("üü£ –£—á–∞—Å—Ç–Ω–∏–∫–∏")
        item_admin = types.KeyboardButton("üîµ –ê–¥–º–∏–Ω")
        item_add_meditation = types.KeyboardButton("üìó –î–æ–±–∞–≤–∏—Ç—å –º–µ–¥–∏—Ç–∞—Ü–∏—é")
        item_delete_meditation = types.KeyboardButton("üìï –£–¥–∞–ª–∏—Ç—å –ú–µ–¥–∏—Ç–∞—Ü–∏—é")
        item_all_meditations = types.KeyboardButton("üìô –í—Å–µ –º–µ–¥–∏—Ç–∞—Ü–∏–∏")

        # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –≤ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
        markup.add(item_add_meditation)
        markup.add(item_publish, item_add)
        markup.add(item_show_all_files, item_all_meditations)
        markup.add(item_remove, item_delete_meditation)
        markup.add(item_admin, item_user_count)

        # –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ –≤—Ö–æ–¥–µ –≤ —Ä–µ–∂–∏–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        bot.send_message(user_id, "–í—ã –≤–æ—à–ª–∏ –≤ —Ä–µ–∂–∏–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.", reply_markup=markup)
    except Exception as e:
        # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è, –µ—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
        print(f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –≤ send_admin_keyboard: {e}")


# –ú–µ—Ç–æ–¥ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∫–ª—é—á–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≤—Ä–µ–º–µ–Ω–∏
def generate_unique_key(user_id):
    try:
        # –°–æ–∑–¥–∞–µ–º –±–∞–∑–æ–≤—É—é —Å—Ç—Ä–æ–∫—É –¥–ª—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
        base_str = f"med_{user_id}_{int(time.time())}"
        # –°–æ–∑–¥–∞–µ–º MD5 —Ö—ç—à —ç—Ç–æ–π —Å—Ç—Ä–æ–∫–∏
        md5_hash = hashlib.md5(base_str.encode()).hexdigest()
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–µ—Ä–≤—ã–µ 8 —Å–∏–º–≤–æ–ª–æ–≤ —Ö—ç—à–∞ –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∫–ª—é—á–∞
        return md5_hash[:8]
    except Exception as e:
        # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω–æ –≤–æ–∑–Ω–∏–∫–ª–æ
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∫–ª—é—á–∞: {e}")
        return None  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º None –∏–ª–∏ –¥—Ä—É–≥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã "–î–æ–±–∞–≤–∏—Ç—å –º–µ–¥–∏—Ç–∞—Ü–∏—é"
@bot.message_handler(func=lambda message: message.text == "üìó –î–æ–±–∞–≤–∏—Ç—å –º–µ–¥–∏—Ç–∞—Ü–∏—é")
def handle_add_meditation(message):
    user_id = message.chat.id

    try:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∏–º–µ–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—Ç–∞—Ç—É—Å "admin6556"
        if user_status.get(user_id) == "admin6556":
            msg = bot.send_message(user_id, "–û—Ç–ø—Ä–∞–≤—å—Ç–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª –∏–ª–∏ —Ç–µ–∫—Å—Ç –¥–ª—è –º–µ–¥–∏—Ç–∞—Ü–∏–∏.")
            bot.register_next_step_handler(msg, save_meditation)  # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º —Å–ª–µ–¥—É—é—â–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
        else:
            bot.send_message(user_id, "–£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.")
    except Exception as e:
        # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω–æ –≤–æ–∑–Ω–∏–∫–ª–æ
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–æ–º–∞–Ω–¥—ã '–î–æ–±–∞–≤–∏—Ç—å –º–µ–¥–∏—Ç–∞—Ü–∏—é': {e}")
        bot.send_message(user_id, "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–æ–º–∞–Ω–¥—ã '–î–æ–±–∞–≤–∏—Ç—å –º–µ–¥–∏—Ç–∞—Ü–∏—é'.")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –º–µ–¥–∏—Ç–∞—Ü–∏–∏
def save_meditation(message):
    user_id = message.chat.id
    file_id = None
    file_type = None
    caption = ""

    try:
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏ –∏–∑–≤–ª–µ–∫–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ
        if message.content_type == 'text':
            file_type = 'text'
            caption = message.text
        elif message.content_type == 'photo':
            file_id = message.photo[-1].file_id
            file_type = 'photo'
            caption = message.caption or ""
        elif message.content_type in ['audio', 'video', 'document', 'voice', 'video_note']:
            file_id = getattr(message, message.content_type).file_id
            file_type = message.content_type
            caption = message.caption or ""
        else:
            bot.send_message(user_id, "–≠—Ç–æ—Ç —Ç–∏–ø —Ñ–∞–π–ª–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è.")
            return

        unique_key = generate_unique_key(user_id)

    except Exception as e:
        # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω–æ –≤–æ–∑–Ω–∏–∫–ª–æ
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –º–µ–¥–∏—Ç–∞—Ü–∏–∏: {e}")
        bot.send_message(user_id, "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –º–µ–¥–∏—Ç–∞—Ü–∏–∏.")
        return

        # –ó–¥–µ—Å—å –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö

    unique_key = generate_unique_key(user_id)

    try:
        # –í—ã–ø–æ–ª–Ω—è–µ–º –æ–ø–µ—Ä–∞—Ü–∏—é –≤—Å—Ç–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
        cursor.execute("INSERT INTO meditate (file_id, file_type, unique_key, caption) VALUES (?, ?, ?, ?)",
                       (file_id, file_type, unique_key, caption))
        conn.commit()  # –§–∏–∫—Å–∏—Ä—É–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
        bot.send_message(user_id, f"–ú–µ–¥–∏—Ç–∞—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ. –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á: {unique_key}")
    except sqlite3.IntegrityError:
        bot.send_message(user_id, "–¢–∞–∫–æ–π –º–µ–¥–∏—Ç–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.")
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –º–µ–¥–∏—Ç–∞—Ü–∏–∏: {e}")
        bot.send_message(user_id, "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –º–µ–¥–∏—Ç–∞—Ü–∏–∏.")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –ú–µ–¥–∏—Ç–∞—Ü–∏–∏
@bot.message_handler(
    func=lambda message: message.text == "üìï –£–¥–∞–ª–∏—Ç—å –ú–µ–¥–∏—Ç–∞—Ü–∏—é" and user_status.get(message.chat.id) == "admin6556")
def handle_delete_meditation_command(message):
    user_id = message.chat.id
    try:
        # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞
        user_status[user_id] = 'admin_deleting_meditation'
        # –ó–∞–ø—Ä–æ—Å–∏—Ç—å —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á
        markup = types.ForceReply(selective=False)
        bot.send_message(user_id, "–í–≤–µ–¥–∏—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á –º–µ–¥–∏—Ç–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—É—é –≤—ã —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å.", reply_markup=markup)
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∫–ª—é—á–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –º–µ–¥–∏—Ç–∞—Ü–∏–∏: {e}")
        bot.send_message(user_id,
                         "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –∫–ª—é—á–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –º–µ–¥–∏—Ç–∞—Ü–∏–∏. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –≤–≤–æ–¥–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∫–ª—é—á–∞ –∏ —É–¥–∞–ª–µ–Ω–∏—è –º–µ–¥–∏—Ç–∞—Ü–∏–∏:
@bot.message_handler(func=lambda message: user_status.get(message.chat.id) == 'admin_deleting_meditation')
def handle_meditation_key_input(message):
    user_id = message.chat.id
    unique_key = message.text.strip()

    try:
        # –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        cursor.execute("DELETE FROM meditate WHERE unique_key = ?", (unique_key,))
        if cursor.rowcount == 0:
            # –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –±—ã–ª–æ —É–¥–∞–ª–µ–Ω–æ, —Å–æ–æ–±—â–∏—Ç—å –æ–± —ç—Ç–æ–º
            bot.send_message(user_id, "–ú–µ–¥–∏—Ç–∞—Ü–∏—è —Å —Ç–∞–∫–∏–º –∫–ª—é—á–æ–º –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.")
        else:
            # –ï—Å–ª–∏ —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ, –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —ç—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
            conn.commit()
            bot.send_message(user_id, "–ú–µ–¥–∏—Ç–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–∞.")
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –º–µ–¥–∏—Ç–∞—Ü–∏–∏: {e}")
        bot.send_message(user_id, "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –º–µ–¥–∏—Ç–∞—Ü–∏–∏.")
    finally:
        # –í –ª—é–±–æ–º —Å–ª—É—á–∞–µ —Å–±—Ä–æ—Å–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        user_status[user_id] = None


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∫–æ–º–∞–Ω–¥—ã "üìô –í—Å–µ –º–µ–¥–∏—Ç–∞—Ü–∏–∏", –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–π –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
@bot.message_handler(
    func=lambda message: message.text == "üìô –í—Å–µ –º–µ–¥–∏—Ç–∞—Ü–∏–∏" and user_status.get(message.chat.id) == "admin6556")
def handle_show_all_meditations(message):
    try:
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–±–æ –≤—Å–µ—Ö —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –º–µ–¥–∏—Ç–∞—Ü–∏—è—Ö
        meditations_info = get_all_saved_meditations_with_keys()

        # –ï—Å–ª–∏ –º–µ–¥–∏—Ç–∞—Ü–∏–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç, —Å–æ–æ–±—â–∞–µ–º –æ–± —ç—Ç–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
        if not meditations_info:
            bot.send_message(message.chat.id, "–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –º–µ–¥–∏—Ç–∞—Ü–∏–π.")
            return

        # –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –º–µ–¥–∏—Ç–∞—Ü–∏—è—Ö –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
        markup = create_meditation_info_buttons(meditations_info)

        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ –º–µ–¥–∏—Ç–∞—Ü–∏–∏
        bot.send_message(message.chat.id, "–í—ã–±–µ—Ä–∏—Ç–µ –º–µ–¥–∏—Ç–∞—Ü–∏—é –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏—è:", reply_markup=markup)
    except Exception as e:
        # –õ–æ–≥–∏—Ä—É–µ–º –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∏ —Å–æ–æ–±—â–∞–µ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –æ–± –æ—à–∏–±–∫–µ
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∫–∞–∑–µ –≤—Å–µ—Ö –º–µ–¥–∏—Ç–∞—Ü–∏–π: {e}")
        bot.send_message(message.chat.id, "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –º–µ–¥–∏—Ç–∞—Ü–∏–∏.")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞–∂–∞—Ç–∏–µ–º –∫–Ω–æ–ø–æ–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
@bot.callback_query_handler(func=lambda call: call.data.startswith('meditation:'))
def handle_meditation_callback_query(call):
    try:
        # –†–∞–∑–±–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–∏–ø–∞ –º–µ–¥–∏—Ç–∞—Ü–∏–∏ –∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∫–ª—é—á–∞
        _, unique_key = call.data.split(':')
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –º–µ–¥–∏—Ç–∞—Ü–∏–∏ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–º—É –∫–ª—é—á—É
        meditation_info = get_meditation_info_from_db(unique_key)

        # –ï—Å–ª–∏ –º–µ–¥–∏—Ç–∞—Ü–∏—è –Ω–∞–π–¥–µ–Ω–∞, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –µ–µ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç–∏–ø–æ–º
        if meditation_info:
            file_id, file_type, caption = meditation_info
            # –ï—Å–ª–∏ —ç—Ç–æ —Ç–µ–∫—Å—Ç–æ–≤–∞—è –º–µ–¥–∏—Ç–∞—Ü–∏—è, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç
            if file_type == 'text':
                bot.send_message(call.message.chat.id, caption)
            else:
                # –î–ª—è –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç —Å –ø–æ–¥–ø–∏—Å—å—é
                send_media(call.message.chat.id, file_type, file_id, caption)
        else:
            # –ï—Å–ª–∏ –º–µ–¥–∏—Ç–∞—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —ç—Ç–æ–º
            bot.answer_callback_query(call.id, "–ú–µ–¥–∏—Ç–∞—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.")
    except Exception as e:
        # –õ–æ–≥–∏—Ä—É–µ–º –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ callback –∑–∞–ø—Ä–æ—Å–∞: {e}")
        bot.answer_callback_query(call.id, "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –≤–∞—à–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞.")


# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –º–µ–¥–∏—Ç–∞—Ü–∏–π —Å –∏—Ö —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏.
def get_all_saved_meditations_with_keys():
    try:
        # –í—ã–ø–æ–ª–Ω—è–µ–º –∑–∞–ø—Ä–æ—Å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –º–µ–¥–∏—Ç–∞—Ü–∏–π —Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π –ø–æ —É–±—ã–≤–∞–Ω–∏—é ID
        cursor.execute("SELECT unique_key, file_type, caption FROM meditate ORDER BY id DESC")
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
        meditations = cursor.fetchall()
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –º–µ–¥–∏—Ç–∞—Ü–∏–π
        return meditations
    except Exception as e:
        # –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏, –ø–µ—á–∞—Ç–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ—à–∏–±–∫–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –º–µ–¥–∏—Ç–∞—Ü–∏–π: {e}")
        return []


# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –º–µ–¥–∏—Ç–∞—Ü–∏–∏ –ø–æ –µ–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ–º—É –∫–ª—é—á—É.
def get_meditation_info_from_db(unique_key):
    try:
        # –í—ã–ø–æ–ª–Ω—è–µ–º –∑–∞–ø—Ä–æ—Å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–µ–¥–∏—Ç–∞—Ü–∏–∏ –ø–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–º—É –∫–ª—é—á—É
        cursor.execute("SELECT file_id, file_type, caption FROM meditate WHERE unique_key = ?", (unique_key,))
        # –ü–æ–ª—É—á–∞–µ–º –æ–¥–∏–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        meditation_info = cursor.fetchone()
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –º–µ–¥–∏—Ç–∞—Ü–∏–∏, –µ—Å–ª–∏ –æ–Ω–∞ –Ω–∞–π–¥–µ–Ω–∞
        return meditation_info
    except Exception as e:
        # –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏, –ø–µ—á–∞—Ç–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ—à–∏–±–∫–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º None
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–µ–¥–∏—Ç–∞—Ü–∏–∏: {e}")
        return None


# –°–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –º–µ–Ω—é —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –º–µ–¥–∏—Ç–∞—Ü–∏—è—Ö.
def create_meditation_info_buttons(meditations_info):
    try:
        # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é —Ä–∞–∑–º–µ—Ç–∫—É –¥–ª—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
        markup = types.InlineKeyboardMarkup()
        # –î–ª—è –∫–∞–∂–¥–æ–π –º–µ–¥–∏—Ç–∞—Ü–∏–∏ –≤ —Å–ø–∏—Å–∫–µ —Å–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫—É
        for unique_key, file_type, caption in meditations_info:
            # –¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ –º–æ–∂–µ—Ç –≤–∫–ª—é—á–∞—Ç—å —Ç–∏–ø —Ñ–∞–π–ª–∞ –∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å
            button_text = f"{file_type.capitalize()}: {caption if caption else '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è'}: {unique_key}"
            # –î–∞–Ω–Ω—ã–µ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç –ø—Ä–µ—Ñ–∏–∫—Å –∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á
            callback_data = f"meditation:{unique_key}"
            # –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –≤ —Ä–∞–∑–º–µ—Ç–∫—É
            markup.add(types.InlineKeyboardButton(button_text, callback_data=callback_data))
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–∞–∑–º–µ—Ç–∫—É —Å –∫–Ω–æ–ø–∫–∞–º–∏
        return markup
    except Exception as e:
        # –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏, –ø–µ—á–∞—Ç–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ—à–∏–±–∫–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º None
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–Ω–æ–ø–æ–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–µ–¥–∏—Ç–∞—Ü–∏–∏: {e}")
        return None


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∫–æ–º–∞–Ω–¥—ã "üü† –í—Å–µ –∞–Ω–æ–Ω—Å—ã", –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–π –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
@bot.message_handler(
    func=lambda message: message.text == "üü† –í—Å–µ –∞–Ω–æ–Ω—Å—ã" and user_status.get(message.chat.id) == "admin6556")
def handle_show_all_files(message):
    try:
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–±–æ –≤—Å–µ—Ö —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö
        file_infos = get_all_saved_files_with_keys()

        # –ï—Å–ª–∏ —Ñ–∞–π–ª—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç, —Å–æ–æ–±—â–∞–µ–º –æ–± —ç—Ç–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
        if not file_infos:
            bot.send_message(message.chat.id, "–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –∞–Ω–æ–Ω—Å–æ–≤.")
            return

        # –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ñ–∞–π–ª–∞—Ö –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
        markup = create_file_info_buttons(file_infos)

        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ –∞–Ω–æ–Ω—Å–∞
        bot.send_message(message.chat.id, "–í—ã–±–µ—Ä–∏—Ç–µ –∞–Ω–æ–Ω—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏—è:", reply_markup=markup)
    except Exception as e:
        # –õ–æ–≥–∏—Ä—É–µ–º –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∏ —Å–æ–æ–±—â–∞–µ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –æ–± –æ—à–∏–±–∫–µ
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∫–∞–∑–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤: {e}")
        bot.send_message(message.chat.id, "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã.")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞–∂–∞—Ç–∏–µ–º –∫–Ω–æ–ø–æ–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
@bot.callback_query_handler(func=lambda call: call.data.startswith('admin6556:'))
def handle_admin_callback_query(call):
    try:
        # –†–∞–∑–±–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞ –∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∫–ª—é—á–∞
        _, file_type, unique_key = call.data.split(':')
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–µ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–º—É –∫–ª—é—á—É
        file_info = get_file_info_from_db(unique_key)

        # –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–∞–π–¥–µ–Ω, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –µ–≥–æ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç–∏–ø–æ–º
        if file_info:
            file_id, caption = file_info
            # –ï—Å–ª–∏ —ç—Ç–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–π –∞–Ω–æ–Ω—Å, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç
            if file_type == 'text':
                bot.send_message(call.message.chat.id, caption)
            else:
                # –î–ª—è –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç —Å –ø–æ–¥–ø–∏—Å—å—é
                send_media(call.message.chat.id, file_type, file_id, caption)
        else:
            # –ï—Å–ª–∏ –∞–Ω–æ–Ω—Å –Ω–µ –Ω–∞–π–¥–µ–Ω, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —ç—Ç–æ–º
            bot.answer_callback_query(call.id, "–ê–Ω–æ–Ω—Å –Ω–µ –Ω–∞–π–¥–µ–Ω.")
    except Exception as e:
        # –õ–æ–≥–∏—Ä—É–µ–º –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ callback –∑–∞–ø—Ä–æ—Å–∞: {e}")
        bot.answer_callback_query(call.id, "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –≤–∞—à–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞.")


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ–∞–π–ª–µ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
def remove_media_from_db(unique_key):
    try:
        cursor.execute('DELETE FROM media WHERE unique_key = ?', (unique_key,))
        conn.commit()
        return True
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: {e}")
        return False


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –±–æ—Ç–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
@bot.message_handler(
    func=lambda message: message.text == "üü¢ –°–¥–µ–ª–∞—Ç—å –ø–æ—Å—Ç" and user_status.get(message.chat.id) == "admin6556")
def handle_admin_make_post(message):
    try:
        # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ "admin_posting" –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø–æ—Å—Ç–∞
        user_status[message.chat.id] = "admin_posting"
        # –°–æ–∑–¥–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ
        markup = types.ForceReply(selective=False)
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –¥–ª—è –Ω–∞—á–∞–ª–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
        bot.send_message(message.chat.id,
                         "–í—ã –≤ —Ä–µ–∂–∏–º–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø–æ—Å—Ç–æ–≤. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –∏–ª–∏ –º–µ–¥–∏–∞, –∫–æ—Ç–æ—Ä—ã–π —Ö–æ—Ç–∏—Ç–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å.",
                         reply_markup=markup)
    except Exception as e:
        # –í —Å–ª—É—á–∞–µ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –≤—ã–≤–æ–¥–∏–º –æ—à–∏–±–∫—É –≤ –∫–æ–Ω—Å–æ–ª—å
        print(f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –≤ handle_admin_make_post: {e}")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç –∞–¥–º–∏–Ω–∞ –≤ —Ä–µ–∂–∏–º–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø–æ—Å—Ç–æ–≤ –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
@bot.message_handler(func=lambda message: user_status.get(message.chat.id) == "admin_posting",
                     content_types=['text', 'photo', 'audio', 'video', 'document', 'voice', 'video_note'])
def handle_admin_posting(message):
    # –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ ID –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
    user_ids = get_all_users_from_db()

    if message.content_type == 'text':
        # –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –∞–¥–º–∏–Ω–∞ - —Ç–µ–∫—Å—Ç, —Ç–æ —Ä–∞—Å—Å—ã–ª–∞–µ–º –µ–≥–æ –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
        for user_id in user_ids:
            try:
                bot.send_message(user_id, message.text)
            except Exception as e:
                # –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è, –≤—ã–≤–æ–¥–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –≤ –∫–æ–Ω—Å–æ–ª—å
                print(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {user_id}: {e}")
    else:
        # –ï—Å–ª–∏ –∞–¥–º–∏–Ω –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –º–µ–¥–∏–∞—Ñ–∞–π–ª (—Ñ–æ—Ç–æ, –∞—É–¥–∏–æ –∏ —Ç.–¥.), —Ä–∞—Å—Å—ã–ª–∞–µ–º –µ–≥–æ –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
        for user_id in user_ids:
            try:
                # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –º–µ–¥–∏–∞—Ñ–∞–π–ª
                if message.content_type == 'photo':
                    bot.send_photo(user_id, message.photo[-1].file_id, caption=message.caption)
                elif message.content_type == 'audio':
                    bot.send_audio(user_id, message.audio.file_id, caption=message.caption)
                elif message.content_type == 'video':
                    bot.send_video(user_id, message.video.file_id, caption=message.caption)
                elif message.content_type == 'document':
                    bot.send_document(user_id, message.document.file_id, caption=message.caption)
                elif message.content_type == 'voice':
                    bot.send_voice(user_id, message.voice.file_id)
                elif message.content_type == 'video_note':
                    bot.send_video_note(user_id, message.video_note.file_id)
            except Exception as e:
                # –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –º–µ–¥–∏–∞—Ñ–∞–π–ª–∞, –≤—ã–≤–æ–¥–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –≤ –∫–æ–Ω—Å–æ–ª—å
                print(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –º–µ–¥–∏–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {user_id}: {e}")

    # –ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è-–∞–¥–º–∏–Ω–∞
    bot.send_message(message.chat.id, "–ü–æ—Å—Ç —É—Å–ø–µ—à–Ω–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω.")
    user_status[message.chat.id] = None


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ—Ä–æ—Ç–∫–æ–≥–æ –∫–ª—é—á–∞ –¥–ª—è file_id
def create_unique_key(file_id):
    try:
        # –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è MD5 —Ö—ç—à –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∫–ª—é—á–∞
        unique_key = hashlib.md5(file_id.encode('utf-8')).hexdigest()[:8]
        return unique_key
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∫–ª—é—á–∞: {e}")
        # –ú–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å None –∏–ª–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π –∫–ª—é—á, –∏–ª–∏ –∂–µ –ø–æ–¥–Ω—è—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –¥–∞–ª—å—à–µ
        return None


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ–∞–π–ª–µ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
def save_media_to_db(file_type, file_id):
    try:
        unique_key = create_unique_key(file_id)
        cursor.execute('INSERT INTO media (unique_key, file_id, file_type) VALUES (?, ?, ?)',
                       (unique_key, file_id, file_type))
        conn.commit()
        return unique_key
    except sqlite3.Error as e:
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö: {e}")
        return None


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–Ω–æ–Ω—Å–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
# –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –∏ –µ–≥–æ –ø–æ–¥–ø–∏—Å–∏ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∫–ª—é—á–æ–º
def save_file_to_db_with_key(file_type, file_id, caption):
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–æ—Ä–æ—Ç–∫–∏–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á –¥–ª–∏–Ω–æ–π 8 —Å–∏–º–≤–æ–ª–æ–≤
    unique_key = shortuuid.ShortUUID().random(length=8)
    try:
        # –ü—ã—Ç–∞–µ–º—Å—è –≤—Å—Ç–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –æ –º–µ–¥–∏–∞—Ñ–∞–π–ª–µ –≤ —Ç–∞–±–ª–∏—Ü—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        cursor.execute("INSERT INTO media (file_id, file_type, unique_key, caption) VALUES (?, ?, ?, ?)",
                       (file_id, file_type, unique_key, caption))
        conn.commit()
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á, –µ—Å–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ
        return unique_key
    except sqlite3.Error as e:
        # –í —Å–ª—É—á–∞–µ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –æ—à–∏–±–∫–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö, –≤—ã–≤–æ–¥–∏–º –µ–µ –≤ –∫–æ–Ω—Å–æ–ª—å
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö: {e}")
        return None


@bot.message_handler(
    func=lambda message: message.text == "üü¢ –î–æ–±–∞–≤–∏—Ç—å –∞–Ω–æ–Ω—Å" and user_status.get(message.chat.id) == "admin6556")
def handle_admin_add_announcement(message):
    try:
        # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ "admin_adding_announcement"
        user_status[message.chat.id] = "admin_adding_announcement"
        # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ç–µ–∫—Å—Ç –∞–Ω–æ–Ω—Å–∞ –∏–ª–∏ —Ñ–∞–π–ª
        markup = types.ForceReply(selective=False)
        bot.send_message(message.chat.id,
                         "–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –∞–Ω–æ–Ω—Å–∞ –∏–ª–∏ —Ñ–∞–π–ª –¥–ª—è –∞–Ω–æ–Ω—Å–∞ —Å –ø–æ–¥–ø–∏—Å—å—é (–µ—Å–ª–∏ —ç—Ç–æ —Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ –∏–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç, –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç–µ –ø–æ–¥–ø–∏—Å—å –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –∫ —Ñ–∞–π–ª—É).",
                         reply_markup=markup)
    except Exception as e:
        # –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –≤—ã–≤–æ–¥–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
        print(f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –≤ handle_admin_add_announcement: {e}")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ç–µ–∫—Å—Ç–∞ –∞–Ω–æ–Ω—Å–∞ –æ—Ç –∞–¥–º–∏–Ω–∞
@bot.message_handler(func=lambda message: user_status.get(
    message.chat.id) == "admin_adding_announcement" and message.content_type == 'text')
def handle_announcement_text(message):
    try:
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—Å—Ç –∫–∞–∫ –ø–æ–¥–ø–∏—Å—å –¥–ª—è –∞–Ω–æ–Ω—Å–∞
        caption = message.text
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∞–Ω–æ–Ω—Å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–ª—É—á–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á
        unique_key = save_file_to_db_with_key('text', None, caption)
        # –°–æ–æ–±—â–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ–± —É—Å–ø–µ—à–Ω–æ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∞–Ω–æ–Ω—Å–∞
        bot.send_message(message.chat.id, f"–¢–µ–∫—Å—Ç –∞–Ω–æ–Ω—Å–∞ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω. –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á: {unique_key}")
        # –°–±—Ä–æ—Å —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–Ω–æ–Ω—Å–∞
        user_status[message.chat.id] = None
    except Exception as e:
        # –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –≤—ã–≤–æ–¥–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
        print(f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –≤ handle_announcement_text: {e}")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
@bot.message_handler(func=lambda message: user_status.get(message.chat.id) == "admin_text")
def handle_admin_text_message(message):
    try:
        # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π –∞–Ω–æ–Ω—Å
        text = message.text
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—Å—Ç –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–ª—É—á–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
        unique_key = save_media_to_db('text', text)
        bot.send_message(message.chat.id, f"–¢–µ–∫—Å—Ç –¥–æ–±–∞–≤–ª–µ–Ω. –ö–ª—é—á –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è: {unique_key}")
        # –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞, –æ–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        user_status[message.chat.id] = "admin"
    except Exception as e:
        # –í —Å–ª—É—á–∞–µ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –æ—à–∏–±–∫–∏ –≤—ã–≤–æ–¥–∏–º –µ–µ –∏ —É–≤–µ–¥–æ–º–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        print(f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: {e}")
        bot.send_message(message.chat.id, "–ò–∑–≤–∏–Ω–∏—Ç–µ, –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ç–µ–∫—Å—Ç–∞.")


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –º–µ–¥–∏–∞ –∏–ª–∏ —Ç–µ–∫—Å—Ç–∞
def send_media(chat_id, file_type, file_id, caption):
    try:
        if file_type == 'audio':
            bot.send_audio(chat_id, file_id, caption=caption)
        elif file_type == 'photo':
            bot.send_photo(chat_id, file_id, caption=caption)
        elif file_type == 'video':
            bot.send_video(chat_id, file_id, caption=caption)
        elif file_type == 'document':
            bot.send_document(chat_id, file_id, caption=caption)
        elif file_type == 'voice':
            bot.send_voice(chat_id, file_id)
            # –ó–¥–µ—Å—å file_id - —ç—Ç–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —Ç–µ–∫—Å—Ç
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –º–µ–¥–∏–∞: {e}")
        bot.send_message(chat_id, "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ –¥–ª—è –∞–Ω–æ–Ω—Å–∞ –æ—Ç –∞–¥–º–∏–Ω–∞
@bot.message_handler(func=lambda message: user_status.get(message.chat.id) == "admin_adding_announcement",
                     content_types=['photo', 'audio', 'video', 'document', 'voice', 'video_note'])
def handle_announcement_file_with_caption(message):
    try:
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è ID —Ñ–∞–π–ª–∞ –∏ –ø–æ–¥–ø–∏—Å–∏ –∫ –Ω–µ–º—É
        file_id = None
        caption = message.caption
        # –î–∞–ª–µ–µ –∫–æ–¥ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ª–æ–≥–∏–∫—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –º–µ–¥–∏–∞—Ñ–∞–π–ª–∞ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–¥–ø–∏—Å—å—é

        # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞ –∏ –µ–≥–æ ID
        if message.content_type == 'photo':
            file_id = message.photo[-1].file_id
            file_type = 'photo'
        elif message.content_type == 'audio':
            file_id = message.audio.file_id
            file_type = 'audio'
        elif message.content_type == 'video':
            file_id = message.video.file_id
            file_type = 'video'
        elif message.content_type == 'document':
            file_id = message.document.file_id
            file_type = 'document'
        elif message.content_type == 'voice':
            file_id = message.voice.file_id
            file_type = 'voice'

        # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –∏ –ø–æ–¥–ø–∏—Å–∏ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
        if file_id:
            unique_key = save_file_to_db_with_key(file_type, file_id, caption)
            bot.send_message(message.chat.id, f"–ê–Ω–æ–Ω—Å —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω. –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á: {unique_key}")
        else:
            bot.send_message(message.chat.id, "–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∞–Ω–æ–Ω—Å–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.")
    except Exception as e:
        print(f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –≤ handle_announcement_file_with_caption: {e}")

    # –°–±—Ä–æ—Å —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞
    user_status[message.chat.id] = None


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è file_id –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–º—É –∫–ª—é—á—É
def get_file_id_from_db(unique_key):
    try:
        cursor.execute("SELECT file_id, caption FROM media WHERE unique_key = ?", (unique_key,))
        row = cursor.fetchone()
        return row[0] if row[0] else row[1]
    except sqlite3.Error as e:
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: {e}")
        return None


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ–∞–π–ª–µ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
def get_file_info_from_db(unique_key):
    try:
        cursor.execute("SELECT file_id, caption FROM media WHERE unique_key = ?", (unique_key,))
        return cursor.fetchone()  # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ç–µ–∂ (file_id, caption)
    except sqlite3.Error as e:
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: {e}")
        return None


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∫–æ–º–∞–Ω–¥—ã "üü† –í—Å–µ –∞–Ω–æ–Ω—Å—ã", –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–π –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
@bot.message_handler(
    func=lambda message: message.text == "üü† –í—Å–µ –∞–Ω–æ–Ω—Å—ã" and user_status.get(message.chat.id) == "admin6556")
def handle_show_all_files(message):
    try:
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–±–æ –≤—Å–µ—Ö —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö
        file_infos = get_all_saved_files_with_keys()

        # –ï—Å–ª–∏ —Ñ–∞–π–ª—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç, —Å–æ–æ–±—â–∞–µ–º –æ–± —ç—Ç–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
        if not file_infos:
            bot.send_message(message.chat.id, "–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –∞–Ω–æ–Ω—Å–æ–≤.")
            return

        # –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ñ–∞–π–ª–∞—Ö –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
        markup = create_file_info_buttons(file_infos)

        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ –∞–Ω–æ–Ω—Å–∞
        bot.send_message(message.chat.id, "–í—ã–±–µ—Ä–∏—Ç–µ –∞–Ω–æ–Ω—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏—è:", reply_markup=markup)
    except Exception as e:
        # –õ–æ–≥–∏—Ä—É–µ–º –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∏ —Å–æ–æ–±—â–∞–µ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –æ–± –æ—à–∏–±–∫–µ
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∫–∞–∑–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤: {e}")
        bot.send_message(message.chat.id, "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã.")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞, –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞–∂–∞—Ç–∏–µ–º –∫–Ω–æ–ø–æ–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
@bot.callback_query_handler(func=lambda call: call.data.startswith('admin6556:'))
def handle_admin_callback_query(call):
    try:
        # –†–∞–∑–±–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞ –∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∫–ª—é—á–∞
        _, file_type, unique_key = call.data.split(':')
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–µ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–º—É –∫–ª—é—á—É
        file_info = get_file_info_from_db(unique_key)

        # –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–∞–π–¥–µ–Ω, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –µ–≥–æ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç–∏–ø–æ–º
        if file_info:
            file_id, caption = file_info
            # –ï—Å–ª–∏ —ç—Ç–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–π –∞–Ω–æ–Ω—Å, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç
            if file_type == 'text':
                bot.send_message(call.message.chat.id, caption)
            else:
                # –î–ª—è –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç —Å –ø–æ–¥–ø–∏—Å—å—é
                send_media(call.message.chat.id, file_type, file_id, caption)
        else:
            # –ï—Å–ª–∏ –∞–Ω–æ–Ω—Å –Ω–µ –Ω–∞–π–¥–µ–Ω, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —ç—Ç–æ–º
            bot.answer_callback_query(call.id, "–ê–Ω–æ–Ω—Å –Ω–µ –Ω–∞–π–¥–µ–Ω.")
    except Exception as e:
        # –õ–æ–≥–∏—Ä—É–µ–º –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ callback –∑–∞–ø—Ä–æ—Å–∞: {e}")
        bot.answer_callback_query(call.id, "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –≤–∞—à–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞.")


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ–∞–π–ª–µ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
def remove_media_from_db(unique_key):
    try:
        cursor.execute('DELETE FROM media WHERE unique_key = ?', (unique_key,))
        conn.commit()
        return True
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: {e}")
        return False


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–æ–º–∞–Ω–¥—ã —É–¥–∞–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º.
@bot.message_handler(
    func=lambda message: message.text == "üî¥ –£–¥–∞–ª–∏—Ç—å –∞–Ω–æ–Ω—Å" and user_status.get(message.chat.id) == "admin6556")
def handle_admin_remove_file(message):
    try:
        # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á —Ñ–∞–π–ª–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è.
        bot.send_message(message.chat.id, "–í–≤–µ–¥–∏—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á —Ñ–∞–π–ª–∞, –∫–æ—Ç–æ—Ä—ã–π –≤—ã —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å.")
        # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –≤ —Ä–µ–∂–∏–º —É–¥–∞–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞.
        user_status[message.chat.id] = "admin_remove"
    except Exception as e:
        # –õ–æ–≥–∏—Ä—É–µ–º –æ—à–∏–±–∫—É –∏ —É–≤–µ–¥–æ–º–ª—è–µ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∞–Ω–æ–Ω—Å–∞: {e}")
        bot.send_message(message.chat.id, "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —É–¥–∞–ª–∏—Ç—å –∞–Ω–æ–Ω—Å.")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∞–Ω–æ–Ω—Å–∞. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á –∞–Ω–æ–Ω—Å–∞, –∫–æ—Ç–æ—Ä—ã–π —Ö–æ—á–µ—Ç —É–¥–∞–ª–∏—Ç—å.
@bot.message_handler(func=lambda message: user_status.get(message.chat.id) == "admin_remove")
def handle_delete_file(message):
    # –ù–∞—á–∞–ª–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–æ–º–∞–Ω–¥—ã –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞/–∞–Ω–æ–Ω—Å–∞
    try:
        unique_key = message.text  # –ü–æ–ª—É—á–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á –∞–Ω–æ–Ω—Å–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        if is_announcement_exists(unique_key):  # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –∞–Ω–æ–Ω—Å —Å —Ç–∞–∫–∏–º –∫–ª—é—á–æ–º
            result = remove_media_from_db(unique_key)  # –£–¥–∞–ª–µ–Ω–∏–µ –∞–Ω–æ–Ω—Å–∞ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
            if result:
                # –£–≤–µ–¥–æ–º–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–± —É—Å–ø–µ—à–Ω–æ–º —É–¥–∞–ª–µ–Ω–∏–∏
                bot.send_message(message.chat.id, "–ê–Ω–æ–Ω—Å —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω.")
            else:
                # –°–æ–æ–±—â–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ–± –æ—à–∏–±–∫–µ –≤ —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ —É–¥–∞–ª–µ–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å
                bot.send_message(message.chat.id, "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∞–Ω–æ–Ω—Å–∞.")
        else:
            # –£–≤–µ–¥–æ–º–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –µ—Å–ª–∏ –∞–Ω–æ–Ω—Å —Å —Ç–∞–∫–∏–º –∫–ª—é—á–æ–º –Ω–µ –Ω–∞–π–¥–µ–Ω
            bot.send_message(message.chat.id, "–ê–Ω–æ–Ω—Å –Ω–µ –Ω–∞–π–¥–µ–Ω.")
    except Exception as e:
        # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è, –≤–æ–∑–Ω–∏–∫—à–µ–≥–æ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —É–¥–∞–ª–µ–Ω–∏—è
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∞–Ω–æ–Ω—Å–∞: {e}")
        # –°–æ–æ–±—â–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –æ—à–∏–±–∫–µ
        bot.send_message(message.chat.id, "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —É–¥–∞–ª–∏—Ç—å –∞–Ω–æ–Ω—Å.")
    finally:
        # –í –ª—é–±–æ–º —Å–ª—É—á–∞–µ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ—Å–ª–µ –ø–æ–ø—ã—Ç–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è
        user_status[message.chat.id] = None


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∞–Ω–æ–Ω—Å–∞ —Å –∑–∞–¥–∞–Ω–Ω—ã–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∫–ª—é—á–æ–º –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
def is_announcement_exists(unique_key):
    try:
        # –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ SQL-–∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∞–Ω–æ–Ω—Å–æ–≤ —Å –∑–∞–¥–∞–Ω–Ω—ã–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∫–ª—é—á–æ–º
        cursor.execute('SELECT COUNT(*) FROM media WHERE unique_key = ?', (unique_key,))
        count = cursor.fetchone()[0]
        # –ï—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–æ–ª—å—à–µ –Ω—É–ª—è, –∞–Ω–æ–Ω—Å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        return count > 0
    except Exception as e:
        # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–∫–∏ –≤ —Å–ª—É—á–∞–µ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∞–Ω–æ–Ω—Å–∞: {e}")
        return False


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
def get_all_saved_files_from_db():
    try:
        # –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ SQL-–∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞, —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∫–ª—é—á–∞ –∏ –ø–æ–¥–ø–∏—Å–∏ –≤—Å–µ—Ö –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤
        cursor.execute("SELECT file_type, unique_key, caption FROM media")
        # –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π –∏ –≤–æ–∑–≤—Ä–∞—Ç –∏—Ö –≤ –≤–∏–¥–µ —Å–ø–∏—Å–∫–∞ –∫–æ—Ä—Ç–µ–∂–µ–π
        return cursor.fetchall()
    except sqlite3.Error as e:
        # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–∫–∏ –≤ —Å–ª—É—á–∞–µ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Ñ–∞–π–ª–æ–≤ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: {e}")
        return []


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–æ–º–∞–Ω–¥—ã "–ê–Ω–æ–Ω—Å—ã"
@bot.message_handler(commands=['announce'])
def handle_announce(message):
    try:
        file_infos = get_all_saved_files_from_db()

        if not file_infos:  # –ï—Å–ª–∏ —Å–ø–∏—Å–æ–∫ –ø—É—Å—Ç, –∞–Ω–æ–Ω—Å–æ–≤ –Ω–µ—Ç
            bot.send_message(message.chat.id, "–ê–Ω–æ–Ω—Å–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç. –°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ üôÇ")
            return  # –í—ã—Ö–æ–¥–∏–º –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏, —á—Ç–æ–±—ã –Ω–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥

        # –ï—Å–ª–∏ –∞–Ω–æ–Ω—Å—ã –µ—Å—Ç—å, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏—Ö
        for file_type, unique_key, caption in file_infos:
            # –ï—Å–ª–∏ —Ç–∏–ø —Ñ–∞–π–ª–∞ - —Ç–µ–∫—Å—Ç, —Ç–æ unique_key –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ–∫—Å—Ç
            if file_type == 'text':
                bot.send_message(message.chat.id, caption)  # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –Ω–∞–ø—Ä—è–º—É—é
            else:
                # –î–ª—è –¥—Ä—É–≥–∏—Ö —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤ –ø–æ–ª—É—á–∞–µ–º file_id –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
                file_info = get_file_info_from_db(unique_key)
                if file_info:
                    file_id, _ = file_info  # –ü–æ–ª—É—á–∞–µ–º file_id (–≤—Ç–æ—Ä–æ–π —ç–ª–µ–º–µ–Ω—Ç –∫–æ—Ä—Ç–µ–∂–∞)
                    send_media(message.chat.id, file_type, file_id, caption)  # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –º–µ–¥–∏–∞ —Å –ø–æ–¥–ø–∏—Å—å—é
    except Exception as e:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–æ–º–∞–Ω–¥—ã '–ê–Ω–æ–Ω—Å—ã': {e}")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–ª–ª–±—ç–∫–æ–≤ –æ—Ç –∏–Ω–ª–∞–π–Ω-–∫–ª–∞–≤–∏–∞—Ç—É—Ä –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
@bot.callback_query_handler(func=lambda call: True)
def handle_callback_query(call):
    try:
        # –†–∞–∑–±–∏–≤–∞–µ–º callback_data, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∏–∑ –∫–æ–ª–ª–±—ç–∫–∞, –Ω–∞ —Ç–∏–ø —Ñ–∞–π–ª–∞ –∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á
        file_type, unique_key = call.data.split(':')
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–µ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–º—É –∫–ª—é—á—É
        file_info = get_file_info_from_db(unique_key)

        # –ï—Å–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∞–π–ª–µ –Ω–∞–π–¥–µ–Ω–∞
        if file_info:
            file_id, caption = file_info
            # –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –º–µ–¥–∏–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤ —á–∞—Ç
            send_media(call.message.chat.id, file_type, file_id, caption)
        else:
            # –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, –µ—Å–ª–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
            bot.answer_callback_query(call.id, "–ò–∑–≤–∏–Ω–∏—Ç–µ, —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.")
    except Exception as e:
        # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è, –µ—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–æ–ª–ª–±—ç–∫–∞
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–æ–ª–ª–±—ç–∫–∞: {e}")
        # –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –æ—à–∏–±–∫–µ
        bot.answer_callback_query(call.id, "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞.")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–ª–ª–±—ç–∫–æ–≤ –æ—Ç –∏–Ω–ª–∞–π–Ω-–∫–ª–∞–≤–∏–∞—Ç—É—Ä –¥–ª—è –ê–¥–º–∏–Ω–∞
@bot.callback_query_handler(func=lambda call: not call.data.startswith('admin6556:'))
def handle_callback_query(call):
    try:
        # –†–∞–∑–±–∏–≤–∞–µ–º callback_data –Ω–∞ —Ç–∏–ø —Ñ–∞–π–ª–∞ –∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á
        file_type, unique_key = call.data.split(':')
        file_info = get_file_info_from_db(unique_key)
        file_id, caption = file_info

        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –º–µ–¥–∏–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
        if file_id:
            if file_type == 'audio':
                bot.send_audio(call.message.chat.id, file_id, caption=caption)
            elif file_type == 'photo':
                bot.send_photo(call.message.chat.id, file_id, caption=caption)
            elif file_type == 'video':
                bot.send_video(call.message.chat.id, file_id, caption=caption)
            elif file_type == 'document':
                bot.send_document(call.message.chat.id, file_id, caption=caption)
            elif file_type == 'voice':
                bot.send_voice(call.message.chat.id, file_id, caption=caption)
            elif file_type == 'text':
                # –¢–∞–∫ –∫–∞–∫ —ç—Ç–æ —Ç–µ–∫—Å—Ç, –Ω–∞–º –Ω–µ –Ω—É–∂–µ–Ω file_id, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä—è–º–æ caption
                bot.send_message(call.message.chat.id, caption)
        else:
            bot.answer_callback_query(call.id, "–ò–∑–≤–∏–Ω–∏—Ç–µ, –∞–Ω–æ–Ω—Å –Ω–µ –Ω–∞–π–¥–µ–Ω.")
    except Exception as e:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–æ–ª–ª–±—ç–∫–∞: {e}")


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤ —á–∞—Ç–µ Telegram.
def send_media(chat_id, file_type, file_id, caption):
    try:
        # –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –º–µ–¥–∏–∞—Ñ–∞–π–ª
        if file_type == 'audio':
            # –û—Ç–ø—Ä–∞–≤–∫–∞ –∞—É–¥–∏–æ—Ñ–∞–π–ª–∞ —Å –ø–æ–¥–ø–∏—Å—å—é
            bot.send_audio(chat_id, file_id, caption=caption)
        elif file_type == 'photo':
            # –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —Å –ø–æ–¥–ø–∏—Å—å—é
            bot.send_photo(chat_id, file_id, caption=caption)
        elif file_type == 'video':
            # –û—Ç–ø—Ä–∞–≤–∫–∞ –≤–∏–¥–µ–æ—Ñ–∞–π–ª–∞ —Å –ø–æ–¥–ø–∏—Å—å—é
            bot.send_video(chat_id, file_id, caption=caption)
        elif file_type == 'document':
            # –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å –ø–æ–¥–ø–∏—Å—å—é
            bot.send_document(chat_id, file_id, caption=caption)
        elif file_type == 'voice':
            # –û—Ç–ø—Ä–∞–≤–∫–∞ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è (–∑–∞–º–µ—Ç—å—Ç–µ, –≥–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –∏–º–µ—é—Ç –ø–æ–¥–ø–∏—Å–∏)
            bot.send_voice(chat_id, file_id)

    except Exception as e:
        # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–∫–∏, –µ—Å–ª–∏ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –º–µ–¥–∏–∞ —Ç–∏–ø–∞ '{file_type}' —Å file_id '{file_id}': {e}")
        # –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ –ø—Ä–æ–∏–∑–æ—à–µ–¥—à–µ–π –æ—à–∏–±–∫–µ
        bot.send_message(chat_id, "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ê–¥–º–∏–Ω"
@bot.message_handler(func=lambda message: message.text == "üîµ –ê–¥–º–∏–Ω")
def handle_admin_button(message):
    try:
        # –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –≤—Ö–æ–¥–∞ –≤ —Ä–µ–∂–∏–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        handle_admin(message)
    except Exception as e:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–Ω–æ–ø–∫–∏ '–ê–¥–º–∏–Ω': {e}")


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å –∫–ª—é—á–∞–º–∏
def get_all_saved_files_with_keys():
    try:
        cursor.execute('SELECT file_type, unique_key FROM media')
        return cursor.fetchall()
    except Exception as e:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤: {e}")
        return []


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω–ª–∞–π–Ω-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã —Å –∫–Ω–æ–ø–∫–∞–º–∏ –¥–ª—è —Ñ–∞–π–ª–æ–≤
def create_file_info_buttons(file_infos):
    try:
        markup = InlineKeyboardMarkup()
        for file_type, unique_key in file_infos:
            button_text = f"{file_type.capitalize()} {unique_key}"
            callback_data = f"admin6556:{file_type}:{unique_key}"
            markup.add(InlineKeyboardButton(button_text, callback_data=callback_data))
        return markup
    except Exception as e:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã —Å –∫–Ω–æ–ø–∫–∞–º–∏: {e}")
        return None


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
def get_user_count_from_db():
    try:
        # –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ SQL-–∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ 'users'
        cursor.execute("SELECT COUNT(*) FROM users")
        user_count = cursor.fetchone()[0]  # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞
        return user_count
    except sqlite3.Error as e:
        # –í—ã–≤–æ–¥ –æ—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª—å –≤ —Å–ª—É—á–∞–µ –Ω–µ—É–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: {e}")
        return None


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
def get_all_users_from_db():
    # –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
    connection = sqlite3.connect('media.db')
    # –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –∫—É—Ä—Å–æ—Ä–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è SQL-–∑–∞–ø—Ä–æ—Å–æ–≤
    cursor = connection.cursor()
    try:
        # –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ SQL-–∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ –≤—Å–µ—Ö user_id –∏–∑ —Ç–∞–±–ª–∏—Ü—ã 'users'
        cursor.execute("SELECT user_id FROM users")
        # –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∑–∞–ø—Ä–æ—Å–∞ –≤ —Å–ø–∏—Å–æ–∫ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        user_ids = [row[0] for row in cursor.fetchall()]
    except sqlite3.Error as e:
        # –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –≤—ã–≤–æ–¥–∏–º –µ—ë –≤ –∫–æ–Ω—Å–æ–ª—å –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫
        print(f"–û—à–∏–±–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: {e}")
        user_ids = []
    finally:
        # –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
        connection.close()
    # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–ø–∏—Å–æ–∫ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    return user_ids


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–æ–º–∞–Ω–¥—ã –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º.
@bot.message_handler(
    func=lambda message: message.text == "üü£ –£—á–∞—Å—Ç–Ω–∏–∫–∏" and user_status.get(message.chat.id) == "—Ç–≤–æ—è –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –≤—Ö–æ–¥–∞")
def handle_show_user_count(message):
    try:
        # –ü–æ–ª—É—á–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.
        user_count = get_user_count_from_db()
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.
        bot.send_message(message.chat.id, f"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–æ—Ç–∞: {user_count}")
    except Exception as e:
        # –õ–æ–≥–∏—Ä—É–µ–º –æ—à–∏–±–∫—É –∏ —É–≤–µ–¥–æ–º–ª—è–µ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {e}")
        bot.send_message(message.chat.id, "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö.")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /taro
@bot.message_handler(commands=['taro'])
def handle_taro_command(message):
    try:
        text = (
            "¬´–Ø–∑—ã–∫ —Ç–∞—Ä–æ¬ª - –∞–≤—Ç–æ—Ä—Å–∫–∏–π –∫—É—Ä—Å –ø–æ —Ç–∞—Ä–æ, –ø–æ–¥—Ö–æ–¥—è—â–∏–π –∫–∞–∫ –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤, —Ç–∞–∫ –∏ –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç –≤—ã–π—Ç–∏ –Ω–∞ –Ω–æ–≤—ã–π "
            "—É—Ä–æ–≤–µ–Ω—å –ø–æ–Ω–∏–º–∞–Ω–∏—è –∏ —Ä–∞–±–æ—Ç—ã —Å –∫–∞—Ä—Ç–∞–º–∏!\n\n"
            "ü™Ñ–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –æ–±—É—á–µ–Ω–∏—è, –≥–¥–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ª–æ–∂–∏—Ç—Å—è –∏ –æ—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è –ª—É—á—à–∏–º –æ–±—Ä–∞–∑–æ–º\n"
            "ü™Ñ–ö—É—Ä—Å, –ø–æ—Å–ª–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ –∏—Å–∫–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ. –í—ã –ø–æ–ª—É—á–∏—Ç–µ –≤—Å–µ –∏ –¥–∞–∂–µ –±–æ–ª—å—à–µ\n"
            "ü™Ñ–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–∂–µ –≤–æ –≤—Ä–µ–º—è –∫—É—Ä—Å–∞ –Ω–∞—á–∞—Ç—å –¥–µ–ª–∞—Ç—å —Ä–∞—Å–∫–ª–∞–¥—ã –∏ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å\n"
            "ü™Ñ–û—Å–æ–±–∞—è —Å–∏—Å—Ç–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–∑–ª–æ–∂–∏—Ç –≤—Å–µ –ø–æ –ø–æ–ª–æ—á–∫–∞–º\n"
            "ü™Ñ–ì–ª—É–±–æ–∫–∏–π –∫—É—Ä—Å, –ø–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –∫–æ—Ç–æ—Ä–æ–≥–æ –≤—ã –±—É–¥–µ—Ç–µ TOP —Ç–∞—Ä–æ–ª–æ–≥–æ–º, –≤—ã–¥–µ–ª—è—é—â–∏–º –≤–∞—Å —Å—Ä–µ–¥–∏ –¥—Ä—É–≥–∏—Ö —Å–≤–æ–∏–º–∏ "
            "—Ç–æ–Ω–∫–∏–º–∏ —Ç—Ä–∞–∫—Ç–æ–≤–∫–∞–º–∏ –∏ –ø—Ä–æ–≥–Ω–æ–∑–∞–º–∏\n\n"
            "–ü–æ–º–∏–º–æ —Ç–∞—Ä–æ –Ω–∞ –∫—É—Ä—Å–µ:\n"
            "‚ñ´Ô∏è–û—Å–Ω–æ–≤—ã —ç–Ω–µ—Ä–≥–µ—Ç–∏–∫–∏\n"
            "‚ñ´Ô∏è–ß–∞–∫—Ä–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞\n"
            "‚ñ´Ô∏è–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —ç–Ω–µ—Ä–≥–µ—Ç–∏–∫–∏\n"
            "‚ñ´Ô∏è–ö–∞–∫ —Ä–∞–±–æ—Ç–∞ —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏\n"
            "‚ñ´Ô∏è–ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏\n"
            "‚ñ´Ô∏è–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ç–∞—Ä–æ\n\n"
            "–°—Ç–∞—Ä—Ç - –∑–∏–º–æ–π 2023/2024\n\n"
            "–ó–∞–ø–∏—à–∏—Ç–µ—Å—å –≤ –ª–∏—Å—Ç –ø—Ä–µ–¥–∑–∞–ø–∏—Å–∏ –∏ –ø–æ–ª—É—á–∏—Ç–µ —Å–∞–º–æ–µ –ª—É—á—à–µ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ!")
        # –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏
        markup = InlineKeyboardMarkup()
        button1 = InlineKeyboardButton("–ü—Ä–µ–¥–∑–∞–ø–∏—Å—å",
                                       url="url="http://example.com/reviews")
        # –ó–∞–º–µ–Ω–∏—Ç–µ 'http://example.com/reviews' –Ω–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫—É—é —Å—Å—ã–ª–∫—É, –≥–¥–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –æ—Ç–∑—ã–≤—ã
        button2 = InlineKeyboardButton("–û—Ç–∑—ã–≤—ã", url="http://example.com/reviews")
        markup.add(button1, button2)

        bot.send_message(message.chat.id, text, parse_mode='Markdown', reply_markup=markup)
    except Exception as e:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–æ–º–∞–Ω–¥—ã /taro: {e}")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /consult
@bot.message_handler(commands=['consult'])
def handle_consult_command(message):
    try:
        text = ("–Ø –ø—Ä–æ–≤–æ–∂—É —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏, –≥–ª—É–±–æ–∫–∏–µ –∏ –æ—Ç–∫—Ä—ã–≤–∞—é—â–∏–µ –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏!\n\n"
                "–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è —ç—Ç–æ –Ω–µ –æ–¥–∏–Ω —Ä–∞—Å–∫–ª–∞–¥, –∞ 10-15 —Ä–∞—Å–∫–ª–∞–¥–æ–≤, —Å—Ç–æ–ª—å–∫–æ, —Å–∫–æ–ª—å–∫–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è, —á—Ç–æ–±—ã –≥–ª—É–±–æ–∫–æ –∏ "
                "–ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ —Ä–∞—Å–∫—Ä—ã—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é. –ù–∞–π—Ç–∏ –≤—Å–µ –æ—Ç–≤–µ—Ç—ã!\n\n"
                "–ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π:\n"
                "üîó—Ä–∞–∑–±–æ—Ä –æ–¥–Ω–æ–π —Å—Ñ–µ—Ä—ã –∂–∏–∑–Ω–∏ (–æ—Ç–Ω–æ—à–µ–Ω–∏—è, —Ä–∞–±–æ—Ç–∞ –∏ –¥–µ–Ω—å–≥–∏, –≤—ã–±–æ—Ä—ã)\n"
                "üîó–≥–æ–¥–æ–≤–æ–π –ø—Ä–æ–≥–Ω–æ–∑\n"
                "üîó–í–ò–ü –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è, –≥–¥–µ —Ä–∞–∑–±–∏—Ä–∞—é—Ç—Å—è –≤—Å–µ —Å—Ñ–µ—Ä—ã –Ω–∞ —Å–µ–π—á–∞—Å+ –≥–æ–¥–æ–≤–æ–π —Ä–∞—Å–∫–ª–∞–¥ + –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π —á–∞–∫—Ä + "
                "—Ä–æ–¥–æ–≤—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã + –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ª–Ω—É—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã –∏–∑ –æ–¥–Ω–æ–π —Å—Ñ–µ—Ä—ã\n\n"
                "–ù–µ –≤–∞–∂–Ω–æ, –∫–∞–∫—É—é –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é –≤—ã –≤—ã–±–µ—Ä–µ—Ç–µ, —è –Ω–∞—á–Ω—É –µ–µ —Å —Ä–∞–∑–±–æ—Ä–∞ –≤–∞—Å –∏ –≤–∞—à–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è. –≠—Ç–æ –ø–µ—Ä–≤–∏—á–Ω–æ –∏ "
                "—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ –Ω–∞—à–µ–π –∂–∏–∑–Ω–∏\n\n"
                "–ö–∞–∫ –ø—Ä–æ—Ö–æ–¥–∏—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è:\n"
                "‚ñ´Ô∏è–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è –ø—Ä–æ—Ö–æ–¥–∏—Ç –≤ –∞—É–¥–∏–æ—Ñ–æ—Ä–º–∞—Ç–µ.\n"
                "‚ñ´Ô∏è–ù–∞ –≤—ã—Ö–æ–¥–µ - —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ –∏–∑–ª–æ–∂–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –¥–∞—é—â–∞—è –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ª–Ω—É—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã.\n"
                "–ü–æ–ª—É—á–∞–µ—Ç–µ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –Ω–∞ 40-50 –º–∏–Ω—É—Ç.\n"
                "‚ñ´Ô∏è–û—Ç–≤–µ—á–∞—é –Ω–∞ –≤–∞—à–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã, –µ—Å–ª–∏ –æ–Ω–∏ —É –≤–∞—Å –æ—Å—Ç–∞–Ω—É—Ç—Å—è. –ù–∞ —Å–≤—è–∑–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ –Ω–µ–¥–µ–ª–∏\n"
                "‚ñ´Ô∏è–î–æ—Å—Ç—É–ø –∫ –∑–∞–ø–∏—Å—è–º —É –≤–∞—Å –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∞–≤—Å–µ–≥–¥–∞, –º–æ–∂–µ—Ç–µ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å—Å—è –∫ –Ω–∏–º –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è.\n"
                "‚ñ´Ô∏è–ù–∞ —Ç–∞—Ä–∏—Ñ–µ –í–ò–ü –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–∏–¥–µ–æ —Å–æ–∑–≤–æ–Ω–∞")

        # –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫—É
        markup = InlineKeyboardMarkup()
        button = InlineKeyboardButton("–ó–∞–ø–∏—Å–∞—Ç—å—Å—è", url="url="http://example.com/reviews")
        markup.add(button)
        bot.send_message(message.chat.id, text, reply_markup=markup)
    except Exception as e:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–æ–º–∞–Ω–¥—ã /consult: {e}")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /interesting
@bot.message_handler(commands=['interesting'])
def handle_interesting_command(message):
    try:
        text = "–í—ã –º–æ–∂–µ—Ç–µ –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å–æ –º–Ω–æ–π –ø–æ–±–ª–∏–∂–µ —á–µ—Ä–µ–∑ –º–æ–∏ —Å–æ—Ü —Å–µ—Ç–∏ üïâ"
        markup = types.InlineKeyboardMarkup()

        # –ö–Ω–æ–ø–∫–∞ Telegram –±—É–¥–µ—Ç –Ω–∞–≤–µ—Ä—Ö—É
        item_telegram = types.InlineKeyboardButton("–ú–æ–π Telegram", url="url="http://example.com/reviews")

        # –ö–Ω–æ–ø–∫–∏ Instagram –∏ YouTube –±—É–¥—É—Ç –≤ –æ–¥–Ω–æ–º —Ä—è–¥—É –Ω–∏–∂–µ
        item_instagram = types.InlineKeyboardButton("–ú–æ–π Instagram",
                                                    url="url="http://example.com/reviews")
        item_youtube = types.InlineKeyboardButton("–ú–æ–π YouTube",
                                                  url="url="http://example.com/reviews")

        item_gaide = types.InlineKeyboardButton("–ì–∞–π–¥",
                                                url="http://example.com/reviews")
        markup.row(item_telegram, item_youtube, item_instagram)
        markup.add(item_gaide)

        bot.send_message(message.chat.id, text, reply_markup=markup)
    except Exception as e:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–æ–º–∞–Ω–¥—ã /interesting: {e}")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –ú–æ–π Instagram, –ú–æ–π Telegram –∏ –ú–æ–π YouTube
@bot.message_handler(func=lambda message: message.text == "–ú–æ–π Instagram")
def handle_instagram_button(message):
    try:
        bot.send_message(message.chat.id,
                         "–°—Å—ã–ª–∫–∞ –Ω–∞ –º–æ–π Instagram: url="http://example.com/reviews")
    except Exception as e:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–Ω–æ–ø–∫–∏ –ú–æ–π Instagram: {e}")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ —Ç–µ–∫—Å—Ç "–ú–æ–π Telegram" –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å—Å—ã–ª–∫—É –Ω–∞ Telegram-–∫–∞–Ω–∞–ª
@bot.message_handler(func=lambda message: message.text == "–ú–æ–π Telegram")
def handle_telegram_button(message):
    try:
        # –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å—Å—ã–ª–∫–æ–π –Ω–∞ Telegram-–∫–∞–Ω–∞–ª
        bot.send_message(message.chat.id, "–°—Å—ã–ª–∫–∞ –Ω–∞ –º–æ–π Telegram: url="http://example.com/reviews")
    except Exception as e:
        # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è, –µ—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–Ω–æ–ø–∫–∏ '–ú–æ–π Telegram': {e}")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ —Ç–µ–∫—Å—Ç "–ú–æ–π YouTube" –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å—Å—ã–ª–∫—É –Ω–∞ YouTube –∫–∞–Ω–∞–ª
@bot.message_handler(func=lambda message: message.text == "–ú–æ–π YouTube")
def handle_youtube_button(message):
    try:
        # –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å—Å—ã–ª–∫–æ–π –Ω–∞ YouTube –∫–∞–Ω–∞–ª
        bot.send_message(message.chat.id,
                         "–°—Å—ã–ª–∫–∞ –Ω–∞ –º–æ–π YouTube: url="http://example.com/reviews")
    except Exception as e:
        # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è, –µ—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–Ω–æ–ø–∫–∏ '–ú–æ–π YouTube': {e}")


# –í –∫–æ–Ω—Ü–µ —Ñ–∞–π–ª–∞, –≥–¥–µ –±–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
if __name__ == '__main__':
    try:
        bot.polling(none_stop=True)
    finally:
        # –ó–∞–∫—Ä—ã–≤–∞–µ–º –∫—É—Ä—Å–æ—Ä –∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞
        cursor.close()
        conn.close()  # –ó–∞–∫—Ä—ã–≤–∞–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
